<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
  <meta http-equiv="CONTENT-TYPE" content="text/html; charset=UTF-8">
  <title>glideinWMS - Factory</title>
  <meta name="CREATED" content="0;0">
  <meta name="CHANGED" content="20100521;20081031;14115200">    
  <link rel="stylesheet" type="text/css" href="../common/glideinWMS.css" media="screen, projection" />
</head>

<body lang="en-US" dir="ltr">
    <h1>
        <a href="index.html">GlideinWMS</a>
	<span>The Glidein-based Workflow Management System</span>
    </h1>
    <ul class="breadcrumbs">
	    <li> <a href="../index.html">Home</a></li>
	    <li> <a href="./index.html">WMS Factory</a></li>
	    <li> <a href="./design.html">Design</a></li>
        <li>Entry Internals</li>
    </ul>
    <div class="clear" />
    <div class="leftmenu">
        <ul class="components">
	        <li> <a href="../index.html">Home</a></li>
	        <li> <a href="../download.html">Download</a></li>
	        <li> <a href="../frontend/index.html">Glidein Frontend</a></li>
            <li> <a target="_blank" href="../corral.html">Corral Frontend</a></li>
	        <li> <a href="../factory/index.html">WMS Factory</a></li>
	        <li> <a href="../components/index.html" >Components</a></li>
	        <li> <a href="../components/faq.html" class="last">FAQ</a></li>
        </ul>
        <div class="search">
            <div id="cse-search-form" style="width: 100%;">Loading</div>
            <script src="http://www.google.com/jsapi" type="text/javascript"></script>
            <script src="../common/glidein.js" type="text/javascript"></script>
            <script type="text/javascript">
            google.load('search', '1', {language : 'en', style : google.loader.themes.MINIMALIST});
            google.setOnLoadCallback(onLoad);
            </script>
        </div>
    </div>
    <div id="searchcontent"><h2>Search Results</h2><div id="cse"></div> </div>
<div class="content">
    <div class="heading">
    <img align="right" width="280px" border="0px"
        src="../images/simple_diagram.png" usemap="#rightimage">
    <map name="rightimage">
        <area shape="rect" coords="90,3,177,60" href="../frontend/index.html" />
        <area shape="rect" coords="5,88,118,146" href="../components/collector_install.html" />
        <area shape="rect" coords="134,88,275,146" href="../factory/index.html" />
        <area shape="rect" coords="189,3,274,60" target="_blank" href="../corral.html" />
    </map>

    <h2>WMS Factory Design</h2>
	<ul class="subcomponents">
	     <li> <a href="./index.html">Overview</a></li>
         <li> <a href="./install.html">Install</a></li>
	     <li> <a href="./configuration.html">Configuration</a></li>
	     <li> Design</li>
	     <li> <a href="./monitoring.html">Monitoring</a></li>
	     <li class="last"> <a href="./troubleshooting.html">Troubleshooting</a></li>
	</ul>
        <h3>glideclient classad</h3>
	</div>
<div class="jump">
<u>Jump to:</u>
<ol>
    <LI><A HREF="#userdefined">User defined values</A></li>
    <LI><A HREF="#identify">Identify the classad</A></li>
    <LI><A HREF="#configuration">Configuration and installation</A></li>
    <LI><A HREF="#request">Request info</A></li>
    <LI><A HREF="#security">Encrypted security parameters</A></li>
    <LI><A HREF="#proxy">Proxy information</A></li>    
    <LI><A HREF="#glidein">Frontend glidein info</A></li>
    <LI><A HREF="#monitoring">Monitoring</A></li>
</ol>
</div>
<div class="related">
Factory Design Topics: <br/>
<ul>
<li> <a href="design_factory.html">Factory Internals</a></li>
<li> <a href="design_entry.html">Entry Internals</a></li>
<li> <a href="design_glidein.html">Glidein Internals</a></li>
<li> <a href="design_data_exchange.html">Data Exchange</a></li>
</ul>
</div>
<div class="section">

<h2>Frontend Advertisement of Requests</h2>
<p>The Frontend creates request Classads for the factory to submit glideins. In the 
Frontend configuration, you can either match to all entries or customize the match 
string to request pilots at specific sites.  This match string will use information 
published in the Factory entry Classads and the user&rsquo;s job Classads.</p>
<ol>
	<li><a name="userdefined"></a><b>User defined values.</b>
		<ol type="a">
			<li>Users are <i>not</i> supposed to affect how glideins are submitted. 
			Users can affect where they are submitted when the Frontend configures 
			match expressions and the user provides supported requirements but this 
			all takes place in the Frontend.  User requirements are not put into the 
			Frontend request for the Factory to interpret.</li>
		</ol>
	</li>	

	<li><a name="identify"></a><b>Information used to identify the Classad.</b>
		<ol type="a">
			<li>Values used to manage Classads in the Collector.
				<ul>
					<li>Name = &quot;ReqName@ClientName&quot; This is arbitrary except that it has to be unique for the WMS Collector.  </li>
					<li>Internal classad type of Master</li>
				</ul>
			</li>
			<li>Values used to distinguish the different classad types
				<ul>
					<li>GlideinMyType = &quot;glideclient&quot; </li>
				</ul>
			</li>
			<li>Values set by glideinWMS for consistency but are not used
				<ul>
					<li>MyType = &quot;glideclient&quot;</li>
				</ul>
			</li>
		</ol>
	</li>
	
	<li><a name="configuration"></a><b>Information about the configuration and installation.  </b>  This is used by admins for 
	querying the collector or possibly in match expressions.
		<ol type="a">
			<li>These describe the frontend and group making the request.  
				<ul>
					<li>ClientName  = &quot;frontend_name.group_name&quot;</li>
					<li>FrontendName  = &quot;frontend_name&quot; </li>
					<li>GroupName   = &quot;group_name&quot; </li>
					<li>GlideinWMSVersion = &quot;glideinWMS UNKNOWN&quot;</li>
				</ul>
			</li>
		</ol>
	</li>	
		
	<li><a name="request"></a><b>Information specific to a request.  </b>  
		<ol type="a">
			<li>Information on the numbers related to how many glideins needed.  
				<ul>
					<li>ReqIdleGlideins = 0</li>
					<li>ReqMaxRunningGlideins = 1</li>
				</ul>
			</li>
			<li>The entry that the Frontend needs glideins from.  This value is used to match the request to the entry 
			so it must exactly match the &quot;Name&quot; variable in the entry Classad.
				<ul>
					<li>ReqGlidein = &quot;entry_name&#64;glidein_name@factory_name&quot;</li>
				</ul>
			</li>
			<li>This not used by the Factory so it may contain an arbitrary value.  In VO Frontends, 
			it is used for monitoring and debugging.
				<ul>
					<li>ReqName = &quot;entry_name&#64;glidein_name&#64;factory_name&quot;</li>
				</ul>
			</li>
		</ol>
	</li>	
		
	<li><a name="security"></a><b>Encrypted security parameters.  </b> The Factory and Frontend use these to identify and talk with each other. 
		<ol type="a">
			<li>The Factory Key ID must match the one published by the Factory.  
				<ul>
					<li>ReqPubKeyID = &quot;03910dfe2d1101f80fd4f7c388fd2e1c&quot;</li>
				</ul>
			</li>
			<li>Encrypted symmetric key.
				<ul>
					<li>ReqPubKeyCode = &quot;03910dfe2d1101f80fd4f7c388fd2e1c&quot;</li>
				</ul>
			</li>
			<li>Encrypted identity and security mapping information.  These values will be encrypted in the actual Classad.
				<ul>
					<li>ReqEncIdentity = &quot;frontend_name&#64;factorynode.domain.name&quot;</li>
				</ul>
			</li>
		</ol>
	</li>	
		
	<li><a name="proxy"></a><b>Proxy Information.  </b> All glideins are submitted with a proxy and a Frontend can specify multiple 
	proxies in each request.  All proxy information is prefaced with GlideinEncParam and the values are encrypted.
		<ol type="a">
			<li>The number of proxies being sent.  
				<ul>
					<li>GlideinEncParamnr_x509_proxies = &quot;5&quot;</li>
				</ul>
			</li>
			<li>For each proxy, the identifier is listed as well as the proxy itself. The identifier must not change for a given 
			proxy DN between updates.
				<ul>
					<li>GlideinEncParamx509_proxy_0_identifier = &quot;identifier_for_proxy_0&quot;</li>
					<li>GlideinEncParamx509_proxy_0 = &quot;actual_proxy_0&quot;</li>
					<li>GlideinEncParamx509_proxy_1_identifier = &quot;identifier_for_proxy_0&quot;</li>
					<li>GlideinEncParamx509_proxy_1 = &quot;actual_proxy_0&quot;</li>
					<li>Etc.</li>
				</ul>
			</li>
			<li>The Factory uses the security name for whitelisting Frontends in an entry.  The security class must be agreed 
			upon with the Factory to ensure the correct security mappings exist.  If these are not correct, the Frontend 
			request will be denied.
				<ul>
					<li>GlideinEncParamSecurityName = &quot;frontend_name&quot;</li>
					<li>GlideinEncParamx509_proxy_0_security_class = &quot;frontend&quot;</li>
					<li>GlideinEncParamx509_proxy_1_security_class = &quot;frontend&quot;</li>
					<li>Etc.</li>
				</ul>
			</li>
		</ol>
	</li>	
	
	<li><a name="glidein"></a><b>Frontend defined information for affecting glideins.  </b> 
		<ol type="a">
			<li>Optional Frontend Admin defined variables. They will be prefaced with GlideinParam.  
				<ul>
					<li>GlideinParamUSE_MATCH_AUTH = &quot;True&quot;</li>
					<li>GlideinParamGLIDEIN_Entry_Start = &quot;True&quot;</li>
					<li>Etc.</li>
				</ul>
			</li>
			<li>The Frontend specifies what Collector the glideins will report to and is required.  This value is passed 
			through to the glideins and is not used by the Factory.  
				<ul>
					<li>GlideinParamGLIDEIN_Collector = &quot;collectornode.domain.name:9618&quot;</li>
				</ul>
			</li>
			<li>The Frontend specifies the web staging area where the glideins will download Frontend provided files.  
			A descript file (and signature for verification) is used to point to the files and their signs that will be 
			used in starting the glideins.  A Frontend can also contain groups with additional information so both the 
			Frontend and group descript files are specified.  Refer to <a href="http://www.uscms.org/SoftwareComputing/Grid/WMS/glideinWMS/doc.prd/factory/design_glidein.html">here</a> 
			for the structure of the web area on the Frontend as well as the type and format of files expected.
				<ul>
					<li>WebURL = &quot;http:&frasl;&frasl;frontend.domain.name&frasl;path-to-staging-area&frasl;stage&frasl;frontend_name&quot;</li>
					<li>WebSignType = &quot;sha1&quot;</li>
					<li>WebDescriptFile = &quot;description.abtfgq.cfg&quot;</li>
					<li>WebDescriptSign = &quot;15af90be49a498528828d321f91ca2302&quot;</li>
					<li>WebGroupURL = &quot;http:&frasl;&frasl;cms- frontend.domain.name&frasl;path-to-staging-area&frasl;stage&frasl;frontend_name&frasl;group_name&quot;</li>
					<li>WebGroupDescriptFile = &quot;description.abtfgq.cfg&quot;</li>
					<li>WebGroupDescriptSign = &quot;b7fde1fd2bc02b02dafd85a655c93f090cfa1e51&quot;</li>
				</ul>
			</li>
		</ol>
	</li>	
	
	<li><a name="monitoring"></a><b>Monitoring and debugging values.  </b>  
		<ol type="a">
			<li>These are generated by the Frontend and used for generating the monitoring data. All are prefaced with GlideinMonitor.  Monitoring values may be shared 
			between services but are only used in generating monitoring data and not to affect glidein requests.  
				<ul>
					<li>Any Classad variable that begins with GlideinMonitor: GlideinMonitorRunning = 0, GlideinMonitorGlideinsIdle = 0, etc.</li>
				</ul>
			</li>
		</ol>
	</li>	
</ol>


<h2>Example glideclient classad</h2>
<pre>
MyType = "glideclient"
TargetType = ""
GlideinMyType = "glideclient"
GlideinWMSVersion = "glideinWMS UNKNOWN"
Name = "entry@glidein@factory@frontend-instance.main"
ClientName = "frontend-instance.main"
FrontendName = "frontend-instance"
GroupName = "main"
ReqName = "entry@glidein@factory"
ReqGlidein = " entry@glidein@factory "
WebURL = "http://node.domain.name/vofrontend/stage/frontend"
WebSignType = "sha1"
WebDescriptFile = "description.acgfgp.cfg"
WebDescriptSign = "f878f3762273245aa3d87f05b8c7306be0eff51c"
WebGroupURL = "http://cms-node.domain.name/vofrontend/stage/frontend /group_main"
WebGroupDescriptFile = "description.acgdrf.cfg"
WebGroupDescriptSign = "0e832bcc4e47d388803255ac7a98fbe4580f4961"
ReqPubKeyID = "60b25b1dca401abad2d17c2f5f15e887"
**ReqEncKeyCode = "f8ee5f9f031141071ef5a40f0e0911de3c09f35517335f721fbbe912b32f73"
**ReqEncIdentity = "1dcd10a1ca601b5a55fe27db93b2c8f7242559cd15fed974ac28f153236689d06"
ReqIdleGlideins = 0
ReqMaxRunningGlideins = 1
ReqIdleChunkSize = 1
GlideinParamUSE_MATCH_AUTH = "True"
GlideinParamGLIDEIN_Entry_Start = "True"
GlideinParamGLIDEIN_Entry_Rank = "1"
GlideinParamGLIDEIN_Collector = "node.domain.name"
GlideinMonitorRunning = 0
GlideinMonitorGlideinsRunning = 0
GlideinMonitorIdle = 0
GlideinMonitorGlideinsTotal = 0
GlideinMonitorOldIdle = 0
GlideinMonitorGlideinsIdle = 0
GlideinMonitorRunningHere = 0
GlideinEncParamx509_proxy_0_identifier = "e5e86dea2bc94f357b922ff41866385d"
GlideinEncParamSecurityName = "798a603c1d9017ab1f250d79388e7fe9"
**GlideinEncParamx509_proxy_0 = "79dbcbba4de07ac0578b342db4b63b91a1b12020dc89ab17601d2b634"
GlideinEncParamnr_x509_proxies = "36d9444ae0177f649c492a01e3575806"
GlideinEncParamx509_proxy_0_security_class = "160d7ca0e441da3407675d2003571a3e"
MyAddress = "<111.222.333.44:0>"
AuthenticatedIdentity = "frontend_user@node.domain.name"
LastHeardFrom = 1294182587
UpdatesTotal = 159
UpdatesSequenced = 0
UpdatesLost = 0
UpdatesHistory = "0x00000000000000000000000000000000"

**Note:  This attribute was shortened to fit into this document.
</pre>


</div>
</body>
</html>
